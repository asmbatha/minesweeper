import{a as S,t as F,c as we,d as be}from"../chunks/D2owBE97.js";import{i as Ee}from"../chunks/CbaikpjS.js";import{W as Me,i as xe,m as O,N as P,K as Ae,g as w,L as Ie,M as ie,O as X,o as D,ac as Y,P as ue,j as ve,Q as Ce,aa as de,G as ne,ad as te,ae as Oe,a9 as ke,af as Ne,k as Te,X as ye,ag as Se,a6 as Re,a0 as Le,a1 as De,ah as J,ai as Q,R as qe,B as se,aj as ce,ak as $e,al as He,a4 as Ge,J as ze,I as Be,am as Ye,an as _e,q as Fe,ao as Pe,ap as Xe,t as R,v as Ke,D as Ue,w as q,x as T,y as K,p as Ve,aq as We,ar as Je}from"../chunks/eK6pSGJK.js";import{l as Qe,e as G,s as U}from"../chunks/DgJQ56CA.js";import{i as Ze,a as fe,s as je,b as ea}from"../chunks/5X2v_n5Y.js";import{w as aa}from"../chunks/Bo9MAY2X.js";function V(e,a){return a}function ra(e,a,r,n){for(var i=[],o=a.length,s=0;s<o;s++)Oe(a[s].e,i,!0);var E=o>0&&i.length===0&&r!==null;if(E){var v=r.parentNode;ke(v),v.append(r),n.clear(),k(e,a[0].prev,a[o-1].next)}Ne(i,()=>{for(var h=0;h<o;h++){var d=a[h];E||(n.delete(d.k),k(e,d.prev,d.next)),Te(d.e,!E)}})}function W(e,a,r,n,i,o=null){var s=e,E={flags:a,items:new Map,first:null},v=(a&ce)!==0;if(v){var h=e;s=O?P(ye(h)):h.appendChild(Me())}O&&Ae();var d=null,m=!1,M=Se(()=>{var l=r();return ze(l)?l:l==null?[]:de(l)});xe(()=>{var l=w(M),g=l.length;if(m&&g===0)return;m=g===0;let b=!1;if(O){var C=s.data===Ie;C!==(g===0)&&(s=ie(),P(s),X(!1),b=!0)}if(O){for(var u=null,c,t=0;t<g;t++){if(D.nodeType===8&&D.data===Re){s=D,b=!0,X(!1);break}var p=l[t],f=n(p,t);c=he(D,E,u,null,p,f,t,i,a,r),E.items.set(f,c),u=c}g>0&&P(ie())}if(!O){var _=Le;ia(l,E,s,i,a,(_.f&Y)!==0,n,r)}o!==null&&(g===0?d?ue(d):d=ve(()=>o(s)):d!==null&&Ce(d,()=>{d=null})),b&&X(!0),w(M)}),O&&(s=D)}function ia(e,a,r,n,i,o,s,E){var Z,j,ee,ae;var v=(i&$e)!==0,h=(i&(J|Q))!==0,d=e.length,m=a.items,M=a.first,l=M,g,b=null,C,u=[],c=[],t,p,f,_;if(v)for(_=0;_<d;_+=1)t=e[_],p=s(t,_),f=m.get(p),f!==void 0&&((Z=f.a)==null||Z.measure(),(C??(C=new Set)).add(f));for(_=0;_<d;_+=1){if(t=e[_],p=s(t,_),f=m.get(p),f===void 0){var A=l?l.e.nodes_start:r;b=he(A,a,b,b===null?a.first:b.next,t,p,_,n,i,E),m.set(p,b),u=[],c=[],l=b.next;continue}if(h&&na(f,t,_,i),f.e.f&Y&&(ue(f.e),v&&((j=f.a)==null||j.unfix(),(C??(C=new Set)).delete(f))),f!==l){if(g!==void 0&&g.has(f)){if(u.length<c.length){var N=c[0],x;b=N.prev;var H=u[0],L=u[u.length-1];for(x=0;x<u.length;x+=1)le(u[x],N,r);for(x=0;x<c.length;x+=1)g.delete(c[x]);k(a,H.prev,L.next),k(a,b,H),k(a,L,N),l=N,b=L,_-=1,u=[],c=[]}else g.delete(f),le(f,l,r),k(a,f.prev,f.next),k(a,f,b===null?a.first:b.next),k(a,b,f),b=f;continue}for(u=[],c=[];l!==null&&l.k!==p;)(o||!(l.e.f&Y))&&(g??(g=new Set)).add(l),c.push(l),l=l.next;if(l===null)continue;f=l}u.push(f),b=f,l=f.next}if(l!==null||g!==void 0){for(var I=g===void 0?[]:de(g);l!==null;)(o||!(l.e.f&Y))&&I.push(l),l=l.next;var y=I.length;if(y>0){var me=i&ce&&d===0?r:null;if(v){for(_=0;_<y;_+=1)(ee=I[_].a)==null||ee.measure();for(_=0;_<y;_+=1)(ae=I[_].a)==null||ae.fix()}ra(a,I,me,m)}}v&&De(()=>{var re;if(C!==void 0)for(f of C)(re=f.a)==null||re.apply()}),ne.first=a.first&&a.first.e,ne.last=b&&b.e}function na(e,a,r,n){n&J&&te(e.v,a),n&Q?te(e.i,r):e.i=r}function he(e,a,r,n,i,o,s,E,v,h){var d=(v&J)!==0,m=(v&He)===0,M=d?m?qe(i):se(i):i,l=v&Q?se(s):s,g={i:l,v:M,k:o,a:null,e:null,prev:r,next:n};try{return g.e=ve(()=>E(e,M,l,h),O),g.e.prev=r&&r.e,g.e.next=n&&n.e,r===null?a.first=g:(r.next=g,r.e.next=g.e),n!==null&&(n.prev=g,n.e.prev=g.e),g}finally{}}function le(e,a,r){for(var n=e.next?e.next.e.nodes_start:r,i=a?a.e.nodes_start:r,o=e.e.nodes_start;o!==n;){var s=Ge(o);i.before(o),o=s}}function k(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function ta(e,a,r,n){var i=e.__attributes??(e.__attributes={});O&&(i[a]=e.getAttribute(a)),i[a]!==(i[a]=r)&&("__styles"in e&&(e.__styles={}),r==null?e.removeAttribute(a):typeof r!="string"&&sa(e).includes(a)?e[a]=r:e.setAttribute(a,r))}var oe=new Map;function sa(e){var a=oe.get(e.nodeName);if(a)return a;oe.set(e.nodeName,a=[]);for(var r,n=e,i=Element.prototype;i!==n;){r=Ye(n);for(var o in r)r[o].set&&a.push(o);n=Be(n)}return a}function z(e,a,r){if(r){if(e.classList.contains(a))return;e.classList.add(a)}else{if(!e.classList.contains(a))return;e.classList.remove(a)}}function ge(e,a,r){if(e.multiple)return oa(e,a);for(var n of e.options){var i=$(n);if(Ze(i,a)){n.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function fa(e,a){_e(()=>{var r=new MutationObserver(()=>{var n=e.__value;ge(e,n)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function la(e,a,r=a){var n=!0;Qe(e,"change",i=>{var o=i?"[selected]":":checked",s;if(e.multiple)s=[].map.call(e.querySelectorAll(o),$);else{var E=e.querySelector(o)??e.querySelector("option:not([disabled])");s=E&&$(E)}r(s)}),_e(()=>{var i=a();if(ge(e,i,n),n&&i===void 0){var o=e.querySelector(":checked");o!==null&&(i=$(o),r(i))}e.__value=i,n=!1}),fa(e)}function oa(e,a){for(var r of e.options)r.selected=~a.indexOf($(r))}function $(e){return"__value"in e?e.__value:e.value}const B=aa({board:[],mines:0,revealed:0,gameOver:!1,win:!1,firstClick:!0});function ua(e,a,r){return Array(a).fill(0).map(()=>Array(e).fill(0).map(()=>({isMine:!1,detonated:!1,revealed:!1,flagged:!1,neighborMines:0})))}function va(e,a,r,n){const i=e[0].length,o=e.length,s=new Set;for(let v=-1;v<=1;v++)for(let h=-1;h<=1;h++){const d=n+v,m=r+h;d>=0&&d<o&&m>=0&&m<i&&s.add(`${m},${d}`)}let E=0;for(;E<a;){const v=Math.floor(Math.random()*i),h=Math.floor(Math.random()*o),d=`${v},${h}`;!e[h][v].isMine&&!s.has(d)&&(e[h][v].isMine=!0,E++)}for(let v=0;v<o;v++)for(let h=0;h<i;h++)if(!e[v][h].isMine){let d=0;for(let m=-1;m<=1;m++)for(let M=-1;M<=1;M++)v+m>=0&&v+m<o&&h+M>=0&&h+M<i&&e[v+m][h+M].isMine&&d++;e[v][h].neighborMines=d}}function pe(e,a,r){if(!(a<0||a>=e[0].length||r<0||r>=e.length)&&!(e[r][a].revealed||e[r][a].flagged)&&(e[r][a].revealed=!0,e[r][a].neighborMines===0))for(let n=-1;n<=1;n++)for(let i=-1;i<=1;i++)pe(e,a+i,r+n)}var da=F("<option> </option>"),ca=F('<span class="status svelte-1szxwrc"> </span>'),_a=F('<button class="cell svelte-1szxwrc"><!></button>'),ha=F('<main class="container svelte-1szxwrc"><div class="controls svelte-1szxwrc"><select></select> <button>New Game</button> <!></div> <div class="board svelte-1szxwrc"></div></main>');function Ma(e,a){Fe(a,!1);const[r,n]=je(),i=()=>ea(B,"$gameState",r),o={BEGINNER:{width:9,height:9,mines:10},INTERMEDIATE:{width:16,height:16,mines:40},EXPERT:{width:30,height:16,mines:99}};let s=We(o.BEGINNER);function E(){const u=ua(w(s).width,w(s).height,w(s).mines);B.set({board:u,mines:w(s).mines,revealed:0,gameOver:!1,win:!1,firstClick:!0})}function v(u,c){B.update(t=>{if(t.gameOver)return t;if(t.firstClick&&(va(t.board,t.mines,u,c),t.firstClick=!1),t.board[c][u].isMine)return t.board[c][u].detonated=!0,t.gameOver=!0,t;pe(t.board,u,c);let p=0;return t.board.forEach(f=>{f.forEach(_=>{_.revealed&&p++})}),t.revealed=p,p===w(s).width*w(s).height-w(s).mines&&(t.win=!0,t.gameOver=!0),t})}function h(u,c,t){u.preventDefault(),B.update(p=>(!p.gameOver&&!p.board[t][c].revealed&&(p.board[t][c].flagged=!p.board[t][c].flagged),p))}Pe(()=>{},()=>{E()}),Xe(),Ee();var d=ha(),m=q(d),M=q(m);R(()=>{w(s),Je(()=>{})}),W(M,5,()=>Object.entries(o),V,(u,c)=>{let t=()=>w(c)[0],p=()=>w(c)[1];var f=da(),_={},A=q(f,!0);T(f),R(()=>{_!==(_=p())&&(f.value=(f.__value=p())==null?"":p()),U(A,t())}),S(u,f)}),T(M);var l=K(M,2),g=K(l,2);{var b=u=>{var c=ca(),t=q(c,!0);T(c),R(()=>U(t,i().win?"You Win!":"Game Over!")),S(u,c)};fe(g,u=>{i().gameOver&&u(b)})}T(m);var C=K(m,2);W(C,5,()=>i().board,V,(u,c,t)=>{var p=we(),f=Ve(p);W(f,1,()=>w(c),V,(_,A,N)=>{var x=_a(),H=q(x);{var L=I=>{var y=be();R(()=>U(y,w(A).neighborMines||"")),S(I,y)};fe(H,I=>{w(A).revealed&&!w(A).isMine&&I(L)})}T(x),R(()=>{x.disabled=i().gameOver||w(A).flagged,z(x,"revealed",w(A).revealed),z(x,"mine",w(A).isMine&&i().gameOver),z(x,"flagged",w(A).flagged),z(x,"detonated",w(A).detonated)}),G("click",x,()=>v(N,t)),G("contextmenu",x,I=>h(I,N,t)),S(_,x)}),S(u,p)}),T(C),T(d),R(()=>ta(C,"style",`grid-template-columns: repeat(${w(s).width??""}, 30px);`)),la(M,()=>w(s),u=>Ue(s,u)),G("change",M,E),G("click",l,E),S(e,d),Ke(),n()}export{Ma as component};
